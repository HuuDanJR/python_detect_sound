<%= form_with(model: customer, local: true) do |form| %>
  <div class="row">
    <% if customer.errors.any? %>
      <div class="col-md-12" id="error_explanation">
        <h4><%= pluralize(customer.errors.count, "error" ) %> errors:</h4>
        <ul>
          <% customer.errors.full_messages.each do |message| %>
            <li>
              <%= message %>
            </li>
            <% end %>
        </ul>
      </div>
      <% end %>
  </div>

  <div class="row">
    <div class="col-md-12">
      <div class="card card-secondary">
        <div class="card-header">
          <h3 class="card-title">Information Customer</h3>
        </div>
        <div class="card-body">

          <div class="form-row">
            <div class="form-group col-sm-3">
              <label>
                <%= t('customer_title') %>:
              </label>
              <%= form.text_field :title, class: "form-control" %>
            </div>

            <div class="form-group col-sm-3">
              <label>
                <%= t('customer_forename') %>:
              </label>
              <%= form.text_field :forename, class: "form-control", required: true %>
            </div>

            <div class="form-group col-sm-3">
              <label>
                <%= t('customer_surname') %>:
              </label>
              <%= form.text_field :surname, class: "form-control" %>
            </div>

            <div class="form-group col-sm-3">
              <label>
                <%= t('customer_middle_name') %>:
              </label>
              <%= form.text_field :middle_name, class: "form-control" %>
            </div>

            <div class="form-group col-sm-3">
              <label>
                <%= t('customer_number') %>:
              </label>
              <%= form.number_field :number, class: "form-control" %>
            </div>

            <div class="form-group col-sm-3">
              <label>
                <%= t('customer_card_number') %>:
              </label>
              <%= form.text_field :card_number, class: "form-control" %>
            </div>

            <div class="form-group col-sm-3">
              <label>
                <%= t('customer_age') %>:
              </label>
              <%= form.number_field :age, class: "form-control" %>
            </div>

            <div class="form-group col-sm-3">
              <label>
                <%= t('customer_gender') %>:
              </label>
              <%= form.text_field :gender, class: "form-control" %>
            </div>

            <div class="form-group col-sm-3">
              <label>
                <%= t('birth_day') %>:
              </label>
              <%= form.date_field :date_of_birth, class: "form-control" %>
            </div>
            <div class="form-group col-sm-3">
              <label>
                <%= t('nationality') %>:
              </label>
              <%= form.text_field :nationality, class: "form-control" %>
            </div>
            <div class="form-group col-sm-2">
              <label>
                <%= t('frame_start_date') %>:
              </label>
              <%= form.date_field :frame_start_date, class: "form-control" %>
            </div>
            <div class="form-group col-sm-2">
              <label>
                <%= t('frame_end_date') %>:
              </label>
              <%= form.date_field :frame_end_date, class: "form-control" %>
            </div>
            
            <div class="form-group col-sm-2">
              <label>
                <%= t('last_update_frame_point') %>:
              </label>
              <%= form.date_field :last_update_frame_point, class: "form-control" %>
            </div>
          </div>
          <div class="form-row">
            <div class="field">
              <label>
                <%= t('customer_attach') %>:
              </label>
              <div class="list-img">
                <% if @customer.attachment_id? %>
                  <div>
                    <img id="drag1" src="/attachments/download/<%= @customer.attachment_id %>?version=medium" width="360" height="360">
                  </div>
                  <% end %>
              </div>
              <%= form.file_field :attachment, :multiple=> false, accept: 'image/*', class: "form-control" %>
                <%= form.number_field :attachment_id, class: "form-control" , hidden: true %>
            </div>
          </div>

        </div>

      </div>
      <div class="card card-secondary">
        <div class="card-header">
          <h3 class="card-title">Information Extra</h3>
        </div>
        <div class="card-body">
          <div class="form-row">
            <div class="form-group col-sm-3">
              <label>
                <%= t('customer_premium_player') %>:
              </label>
              <div class="gender-item">
                <%= form.radio_button :premium_player, false %>No
                  <%= form.radio_button :premium_player, true %> Yes
              </div>
            </div>
            <div class="form-group col-sm-3">
              <label>
                <%= t('customer_valid_membership') %>:
              </label>
              <div class="gender-item">
                <%= form.radio_button :valid_membership, false %>No
                  <%= form.radio_button :valid_membership, true %> Yes
              </div>
            </div>
            <div class="form-group col-sm-3">
              <label>
                <%= t('customer_has_online_account') %>:
              </label>
              <div class="gender-item">
                <%= form.radio_button :has_online_account, false %>Offline
                  <%= form.radio_button :has_online_account, true %> Online
              </div>
            </div>
            <div class="form-group col-sm-3">
              <label>
                <%= t('customer_is_guest') %>:
              </label>
              <div class="gender-item">
                <%= form.radio_button :is_guest, false %>No
                  <%= form.radio_button :is_guest, true %> Yes
              </div>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group col-sm-3">
              <label>
                <%= t('customer_cashless_balance') %>:
              </label>
              <%= form.number_field :cashless_balance, class: "form-control", step:"any" %>
            </div>
            <div class="form-group col-sm-3">
              <label>
                <%= t('customer_freeplay_balance') %>:
              </label>
              <%= form.number_field :freeplay_balance, class: "form-control", step:"any" %>
            </div>
            <div class="form-group col-sm-3">
              <label>
                <%= t('customer_comp_balance') %>:
              </label>
              <%= form.number_field :comp_balance, class: "form-control", step:"any" %>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group col-sm-3">
              <label>
                <%= t('customer_player_tier_name') %>:
              </label>
              <%= form.text_field :player_tier_name, class: "form-control" %>
            </div>
            <div class="form-group col-sm-3">
              <label>
                <%= t('customer_player_tier_short_code') %>:
              </label>
              <%= form.text_field :player_tier_short_code, class: "form-control" %>
            </div>
            <div class="form-group col-sm-3">
              <label>
                <%= t('customer_membership_type_name') %>:
              </label>
              <%= form.text_field :membership_type_name, class: "form-control" %>
            </div>
            
            <div class="form-group col-sm-3">
              <label>
                <%= t('membership_last_issue_date') %>:
              </label>
              <%= form.date_field :membership_last_issue_date, class: "form-control" %>
            </div>

          </div>

          <div class="form-row">
            <div class="col-sm-3 form-group">
              <label>
                <%= t('User System Mapping') %>:
              </label>
              <%= form.hidden_field :user_id, id: "user_id" , name: "user_id" %>
                <%= form.select :user_id, options_from_collection_for_select(@users, :id, :email, @customer.user_id),
                  {:include_blank=> '-- User --'}, {class: "form-control select2"} %>
            </div>
            <div class="form-group col-sm-3">
              <label>
                <%= t('customer_loyalty_balance') %>:
              </label>
              <%= form.number_field :loyalty_balance, class: "form-control", step:"any" %>
            </div>
            <div class="form-group col-sm-3">
              <label>
                <%= t('customer_loyalty_points_available') %>:
              </label>
              <%= form.number_field :loyalty_points_available, class: "form-control" %>
            </div>
          </div>
          
        </div>

      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-12">
      <%= link_to 'Back', 'javascript:void(0);', onclick: "window.history.back(); setTimeout(function(){window.location.reload();}, 100);", class: "btn btn-secondary" %>
        <%# <button type="submit" class="btn btn-success float-right" id="btnSubmit">Save</button> %>
      <input class="btn btn-success float-right" name="btnSubmit" data-disable-with="Processing..." type="submit" value="Save" />
    </div>
  </div>
  <% end %>

    <script>
      function delete_att(othis, id) {
        if (confirm('Bạn có muốn xoá?')) {
          $.ajax({
            url: `/attachments/${id}`,
            type: "DELETE",
            dataType: "json",
            success: function (data) {
              $(othis).parent().remove();
            }
          });
        }
      }

      $(function () {
        // $("#customer_user_id").val($("#user_id").val());
      });
    </script>